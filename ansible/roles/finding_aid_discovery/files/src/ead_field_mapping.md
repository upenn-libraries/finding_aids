# EAD Field Mapping

TODO: Are there potentially more copy fields in the solr configuration?

For each EAD, the following fields will be available when doing the indexing:
- `slug`: endpoint slug
- `public_contacts`: endpoint public contacts

All fields values should be stripped of any leading and trailing whitespace, then all whitespace should be replaced with spaces.

| Old Solr Field Name           | New Solr Field Name              | Mapping Rule                                                                                                                                                            | Facet?   | Searchable?                                                                                      | Displayed In                               | Note                                                                                    |
|-------------------------------|----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|--------------------------------------------------------------------------------------------------|--------------------------------------------|-----------------------------------------------------------------------------------------|
| id                            | id                               | join endpoint slug and XML file basename with _                                                                                                                         | no       | yes                                                                                              | show?                                      | confirm we are generating unique, URL-safe values                                       |
| format                        |                                  | "ead"                                                                                                                                                                   | no       | no                                                                                               |                                            | Probably not needed anymore?                                                            |
| xml                           | xml_ss                           | raw XML                                                                                                                                                                 | no       | no                                                                                               |                                            | any escaping needed? this will eb parsed for collection-level info display on show page | 
| email_field                   | contact_email_ssm                | all `public_contacts` emails from Endpoint (see @princeton.edu special override case)                                                                                   | no       | no                                                                                               |                                            |                                                                                         | 
| link_url_field                |                                  | single value @ `/ead/eadheader/eadid/-@url`                                                                                                                             |          |                                                                                                  |                                            | link to EAD itself?                                                                     | 
| repository_url_field          |                                  | ???                                                                                                                                                                     |          |                                                                                                  |                                            | link to Repository webpage?                                                             | 
| creator_field                 | creator_ssim                     | all values @ `/ead/archdesc/did/origination[@label="creator\|corpname\|famname)` with the role appended, the role should remove the first parenthesis and anything after | yes?                                       | yes                                                                                     | index, show             |                                                                                         | 
| title_field                   | title_tsim                       | single value @ `/ead/archdesc/did/unittitle`                                                                                                                            | no?      | yes                                                                                              | index, show                                | should the parsing be/handle multivalued titles?                                        | 
| unitid_field                  | unit_id_ssi                      | single value @ `/ead/archdesc/did/unitid[not(@audience='internal')]`                                                                                                    | no       | yes?                                                                                             |                                            | how is this related to the `id` field?                                                  | 
| prettyunitid_field            |                                  | single values @ `/ead/archdesc/did/unitid[not(@audience='internal')]` then remove all values that match the following regex `'^[^.]*\.'`                                |          |                                                                                                  |                                            |                                                                                         | 
| extent_field                  | extent_ssim                      | all values @ `/ead/archdesc/did/physdesc[1]/extent[1]` then for any digits that have `.0` appended remove `.0`, then in parenthesis append `/ead/archdesc/did/physdesc[1]/extent[2]` after removing anything after the first period, finally lowercase the whole string | no       | yes?                                                                                             | index, show                                |                                                                                         | 
| inclusive_date_field          | inclusive_date_ss                | single value @ if set `/ead/archdesc/did/unitdate[@type='inclusive']` else `/ead/archdesc/did/unitdate[not (@type='bulk')]`                                             |          |                                                                                                  |                                            |                                                                                         | 
| bulk_date_field               |                                  | single value @ `/ead/archdesc/did/unitdate[@type='bulk']` with `/^\s*Bulk/` replace with empty string                                                                   |          |                                                                                                  | index, show                                | i think this is the "raw" date info from the EAD                                        | 
| abstract_scope_contents_field | abstract_scope_contents_tsi      | single value @ `/ead/archdesc/did/abstract` if set                                                                                                                      | no       | yes                                                                                              | index (truncated), show                    | this field often contains HTML markup and a lot of text                                 | 
| date_added_field              |                                  | single value @ `/ead/eadheader/profiledesc/creation/date`, then replace `/T.*/` with empty string                                                                       |          |                                                                                                  |                                            | is this updated on every re-ingest? seems useless if it is                              | 
| preferred_citation_field      |                                  | single value @ `/ead/archdesc/prefercite/p`                                                                                                                             |          |                                                                                                  |                                            |                                                                                         | 
| repository1_field             | repository_name_component_1_???? | single value @ `/ead/archdesc/did/repository/corpname` else if value not there use `/ead/archdesc/did/repository`, then split on `:` and keep the first value           |          |                                                                                                  |                                            | why?                                                                                    | 
| repository2_field             |                                  | single value @ `/ead/archdesc/did/repository/corpname` else if value not there use `/ead/archdesc/did/repository`, then split on `:` and keep the second value          |          |                                                                                                  |                                            | why?                                                                                    | 
| repository3_field             |                                  | single value @ `/ead/archdesc/did/repository/corpname` else if value not there use `/ead/archdesc/did/repository`, then split on `:` and keep the third value           |          |                                                                                                  |                                            | why?                                                                                    | 
| top_repository_facet          | n/a                              | same as `repository1_field`                                                                                                                                             |          |                                                                                                  |                                            | why?                                                                                    | 
| repository_facet              | repositories_ssim                | [`repository1_field`, `repository2_field`].join(': ')                                                                                                                   | yes      | yes                                                                                              | index, show                                |                                                                                         | 
| date_facet                    | TODO                             | This needs a new implementation!!                                                                                                                                       |          |                                                                                                  |                                            |                                                                                         | 
| bulk_date_facet               | see above                        | all values @ `/ead/archdesc/did/unitdate[@type='bulk']/@normal`, then appends an `s` to each one                                                                        |          |                                                                                                  |                                            |                                                                                         | 
| language_facet                | language_ssim                    | all values @ `/ead/archdesc/did/langmaterial/language/@langcode`, then the code should be converted to the appropriate display string using the ISO 639-2 mapping       |          |                                                                                                  |                                            |                                                                                         | 
| name_facet                    | people_ssim ?                    | all distinct values from `.//controlaccess/(persname\                                                                                                                   | famname\ |corpname) \| //origination[@label='creator']` gsub'd `'--', '&#8212;'` ` | yes      | yes                                                                                               |                         | what is the distinction between source for `name_facet` and `subject_person_facet`?     | 
| subject_person_facet          | people_ssim ?                    | all distinct values from `.//controlaccess/(persname\                                                                                                                   | famname)` | yes                                                                                              | yes                                        |                                                                                         |                                                                                         | 
| subject_corporate_name_facet  | corpnames_ssim                   | all distinct values from `.//controlaccess/corpname` gsub'd `'--', '&#8212;'`                                                                                           | yes      | yes                                                                                              |                                            |                                                                                         | 
| creator_facet                 | creator_facet_ssim               | all distinct values from `.//origination[@label='creator']`                                                                                                             |          |                                                                                                  |                                            |                                                                                         | 
| donor_facet                   | donors_ssim                      | all distinct values from `.//controlaccess/persname[@role='Donor (dnr)']`                                                                                               |          |                                                                                                  |                                            |                                                                                         | 
| subject_place_facet           | places_ssim                      | all distinct values from `.//controlaccess/geogname`                                                                                                                    | yes      | yes                                                                                              |                                            |                                                                                         | 
| subject_topic_facet           | subjects_ssim ?                  | all distinct values from `.//controlaccess/subject` gsub'd `\s*\.\s*$',''`                                                                                              | yes      | yes                                                                                              |                                            |                                                                                         | 
| genre_form_facet              | genre_form_ssim                  | all distinct values from `.//controlaccess/genreform`                                                                                                                   |          |                                                                                                  |                                            |                                                                                         | 
| header_bucket_search          | header_tmiv TODO                 | trimmed text @ `eadheader`                                                                                                                                              |          | yes                                                                                              |                                            | probably aggregates all text from EAD header fields                                     | 
| summary_bucket_search         | summary_tmiv TODO                | trimmed text @ `/archdesc/*[name()!='dsc']`                                                                                                                             |          | yes                                                                                              |                                            | are these fields useful for fielded search?                                             | 
| content_bucket_search         | content_tmiv TODO                | trimmed text @ `./archdesc/dsc`                                                                                                                                         |          | yes                                                                                              |                                            |                                                                                         | 
| union_bucket_search           | all_text_timv TODO               | trimmed text @ `.`                                                                                                                                                      |          | yes                                                                                              |                                            | probably aggregates all text from fields intended to be searched over                   | 
